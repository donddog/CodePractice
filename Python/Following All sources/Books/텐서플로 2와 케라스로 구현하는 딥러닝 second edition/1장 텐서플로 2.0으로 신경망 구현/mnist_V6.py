import tensorflow as tf
from tensorflow import keras

from tensorflow.keras.callbacks import TensorBoard
tensorboard_callback = TensorBoard('.logdir')

EPOCHS = 20
BATCH_SIZE = 128
VERBOSE = 1
NB_CLASSES = 10
N_HIDDEN = 128
VALIDATION_SPLIT=0.2
DROPOUT = 0.5

mnist = keras.datasets.mnist

(X_train, Y_train), (X_test, Y_test) = mnist.load_data()

RESHAPED = 784

X_train = X_train.reshape(60000, RESHAPED)
X_test = X_test.reshape(10000, RESHAPED)
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')

X_train, X_test = X_train / 255.0, X_test / 255.0

print(X_train.shape[0], 'train samples')
print(X_test.shape[0], 'test samples')
'''
60000 train samples
10000 test samples
'''

Y_train = tf.keras.utils.to_categorical(Y_train, NB_CLASSES)
Y_test = tf.keras.utils.to_categorical(Y_test, NB_CLASSES)

model = tf.keras.models.Sequential()
model.add(keras.layers.Dense(N_HIDDEN, input_shape=(RESHAPED,), name='dense_layer', activation='relu'))
model.add(keras.layers.Dropout(DROPOUT))
model.add(keras.layers.Dense(N_HIDDEN, name='dense_layer_2', activation='relu'))
model.add(keras.layers.Dropout(DROPOUT))
model.add(keras.layers.Dense(NB_CLASSES, name='dense_layer_3', activation='softmax'))

model.summary()
'''
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_layer (Dense)          (None, 128)               100480    
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense_layer_2 (Dense)        (None, 128)               16512     
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_layer_3 (Dense)        (None, 10)                1290      
=================================================================
Total params: 118,282
Trainable params: 118,282
Non-trainable params: 0
_________________________________________________________________
Train on 48000 samples, validate on 12000 samples
'''

model.compile(optimizer='Adam', loss='categorical_crossentropy', metrics=['accuracy'])

model.fit(X_train, Y_train, batch_size=BATCH_SIZE, epochs=EPOCHS, verbose=VERBOSE,
		  validation_split=VALIDATION_SPLIT, callbacks=[tensorboard_callback])

test_loss, test_acc = model.evaluate(X_test, Y_test)

print('Test accuracy:', test_acc)
'''Test accuracy: 0.9738'''

predictions = model.predict(X_test)
'''
128/48000 [..............................] - ETA: 1:13 - loss: 2.4228 - accuracy: 0.0781
 3840/48000 [=>............................] - ETA: 2s - loss: 1.9635 - accuracy: 0.3229  
 8320/48000 [====>.........................] - ETA: 1s - loss: 1.5481 - accuracy: 0.4791
12800/48000 [=======>......................] - ETA: 0s - loss: 1.2896 - accuracy: 0.5730
17152/48000 [=========>....................] - ETA: 0s - loss: 1.1329 - accuracy: 0.6290
21504/48000 [============>.................] - ETA: 0s - loss: 1.0233 - accuracy: 0.6656
25856/48000 [===============>..............] - ETA: 0s - loss: 0.9400 - accuracy: 0.6953
30336/48000 [=================>............] - ETA: 0s - loss: 0.8739 - accuracy: 0.7188
34816/48000 [====================>.........] - ETA: 0s - loss: 0.8227 - accuracy: 0.7366
39296/48000 [=======================>......] - ETA: 0s - loss: 0.7802 - accuracy: 0.7512
43776/48000 [==========================>...] - ETA: 0s - loss: 0.7442 - accuracy: 0.7640
48000/48000 [==============================] - 1s 19us/sample - loss: 0.7146 - accuracy: 0.7744 - val_loss: 0.2250 - val_accuracy: 0.9351
Epoch 2/20

  128/48000 [..............................] - ETA: 0s - loss: 0.4818 - accuracy: 0.8906
 4480/48000 [=>............................] - ETA: 0s - loss: 0.3749 - accuracy: 0.8902
 8832/48000 [====>.........................] - ETA: 0s - loss: 0.3740 - accuracy: 0.8916
13056/48000 [=======>......................] - ETA: 0s - loss: 0.3668 - accuracy: 0.8932
17280/48000 [=========>....................] - ETA: 0s - loss: 0.3629 - accuracy: 0.8941
21376/48000 [============>.................] - ETA: 0s - loss: 0.3619 - accuracy: 0.8962
25728/48000 [===============>..............] - ETA: 0s - loss: 0.3561 - accuracy: 0.8979
30080/48000 [=================>............] - ETA: 0s - loss: 0.3530 - accuracy: 0.8984
34176/48000 [====================>.........] - ETA: 0s - loss: 0.3493 - accuracy: 0.8994
38528/48000 [=======================>......] - ETA: 0s - loss: 0.3470 - accuracy: 0.8998
42880/48000 [=========================>....] - ETA: 0s - loss: 0.3456 - accuracy: 0.9001
47104/48000 [============================>.] - ETA: 0s - loss: 0.3431 - accuracy: 0.9013
48000/48000 [==============================] - 1s 14us/sample - loss: 0.3411 - accuracy: 0.9019 - val_loss: 0.1691 - val_accuracy: 0.9516
Epoch 3/20

  128/48000 [..............................] - ETA: 1s - loss: 0.2527 - accuracy: 0.9297
 4480/48000 [=>............................] - ETA: 0s - loss: 0.2718 - accuracy: 0.9203
 8832/48000 [====>.........................] - ETA: 0s - loss: 0.2929 - accuracy: 0.9160
13312/48000 [=======>......................] - ETA: 0s - loss: 0.2919 - accuracy: 0.9165
17920/48000 [==========>...................] - ETA: 0s - loss: 0.2959 - accuracy: 0.9165
22400/48000 [=============>................] - ETA: 0s - loss: 0.2887 - accuracy: 0.9179
26880/48000 [===============>..............] - ETA: 0s - loss: 0.2894 - accuracy: 0.9179
31360/48000 [==================>...........] - ETA: 0s - loss: 0.2868 - accuracy: 0.9178
35840/48000 [=====================>........] - ETA: 0s - loss: 0.2852 - accuracy: 0.9182
40448/48000 [========================>.....] - ETA: 0s - loss: 0.2826 - accuracy: 0.9183
45056/48000 [===========================>..] - ETA: 0s - loss: 0.2820 - accuracy: 0.9188
48000/48000 [==============================] - 1s 13us/sample - loss: 0.2817 - accuracy: 0.9189 - val_loss: 0.1438 - val_accuracy: 0.9602
Epoch 4/20

  128/48000 [..............................] - ETA: 0s - loss: 0.2325 - accuracy: 0.9453
 4608/48000 [=>............................] - ETA: 0s - loss: 0.2587 - accuracy: 0.9251
 8960/48000 [====>.........................] - ETA: 0s - loss: 0.2640 - accuracy: 0.9242
13440/48000 [=======>......................] - ETA: 0s - loss: 0.2574 - accuracy: 0.9265
17792/48000 [==========>...................] - ETA: 0s - loss: 0.2512 - accuracy: 0.9285
22272/48000 [============>.................] - ETA: 0s - loss: 0.2529 - accuracy: 0.9279
26880/48000 [===============>..............] - ETA: 0s - loss: 0.2502 - accuracy: 0.9289
31360/48000 [==================>...........] - ETA: 0s - loss: 0.2467 - accuracy: 0.9298
35840/48000 [=====================>........] - ETA: 0s - loss: 0.2466 - accuracy: 0.9294
40448/48000 [========================>.....] - ETA: 0s - loss: 0.2445 - accuracy: 0.9298
45056/48000 [===========================>..] - ETA: 0s - loss: 0.2448 - accuracy: 0.9295
48000/48000 [==============================] - 1s 13us/sample - loss: 0.2442 - accuracy: 0.9296 - val_loss: 0.1293 - val_accuracy: 0.9638
Epoch 5/20

  128/48000 [..............................] - ETA: 0s - loss: 0.3325 - accuracy: 0.9141
 4480/48000 [=>............................] - ETA: 0s - loss: 0.2264 - accuracy: 0.9321
 8960/48000 [====>.........................] - ETA: 0s - loss: 0.2197 - accuracy: 0.9348
13440/48000 [=======>......................] - ETA: 0s - loss: 0.2216 - accuracy: 0.9341
17920/48000 [==========>...................] - ETA: 0s - loss: 0.2233 - accuracy: 0.9338
22400/48000 [=============>................] - ETA: 0s - loss: 0.2216 - accuracy: 0.9339
26752/48000 [===============>..............] - ETA: 0s - loss: 0.2255 - accuracy: 0.9326
31232/48000 [==================>...........] - ETA: 0s - loss: 0.2233 - accuracy: 0.9333
35712/48000 [=====================>........] - ETA: 0s - loss: 0.2250 - accuracy: 0.9333
40192/48000 [========================>.....] - ETA: 0s - loss: 0.2225 - accuracy: 0.9345
44672/48000 [==========================>...] - ETA: 0s - loss: 0.2200 - accuracy: 0.9352
48000/48000 [==============================] - 1s 13us/sample - loss: 0.2203 - accuracy: 0.9353 - val_loss: 0.1229 - val_accuracy: 0.9662
Epoch 6/20

  128/48000 [..............................] - ETA: 0s - loss: 0.1500 - accuracy: 0.9609
 4480/48000 [=>............................] - ETA: 0s - loss: 0.2156 - accuracy: 0.9395
 8960/48000 [====>.........................] - ETA: 0s - loss: 0.2062 - accuracy: 0.9407
13440/48000 [=======>......................] - ETA: 0s - loss: 0.2093 - accuracy: 0.9397
17920/48000 [==========>...................] - ETA: 0s - loss: 0.2082 - accuracy: 0.9398
22272/48000 [============>.................] - ETA: 0s - loss: 0.2072 - accuracy: 0.9399
26624/48000 [===============>..............] - ETA: 0s - loss: 0.2048 - accuracy: 0.9402
31104/48000 [==================>...........] - ETA: 0s - loss: 0.2062 - accuracy: 0.9402
35456/48000 [=====================>........] - ETA: 0s - loss: 0.2024 - accuracy: 0.9413
39936/48000 [=======================>......] - ETA: 0s - loss: 0.2031 - accuracy: 0.9408
44288/48000 [==========================>...] - ETA: 0s - loss: 0.2025 - accuracy: 0.9408
48000/48000 [==============================] - 1s 13us/sample - loss: 0.2018 - accuracy: 0.9413 - val_loss: 0.1157 - val_accuracy: 0.9678
Epoch 7/20

  128/48000 [..............................] - ETA: 0s - loss: 0.2087 - accuracy: 0.9297
 4480/48000 [=>............................] - ETA: 0s - loss: 0.1838 - accuracy: 0.9453
 8704/48000 [====>.........................] - ETA: 0s - loss: 0.1944 - accuracy: 0.9429
13056/48000 [=======>......................] - ETA: 0s - loss: 0.1912 - accuracy: 0.9434
17408/48000 [=========>....................] - ETA: 0s - loss: 0.1891 - accuracy: 0.9446
21888/48000 [============>.................] - ETA: 0s - loss: 0.1871 - accuracy: 0.9448
26240/48000 [===============>..............] - ETA: 0s - loss: 0.1901 - accuracy: 0.9436
30592/48000 [==================>...........] - ETA: 0s - loss: 0.1898 - accuracy: 0.9437
35200/48000 [=====================>........] - ETA: 0s - loss: 0.1887 - accuracy: 0.9444
39808/48000 [=======================>......] - ETA: 0s - loss: 0.1894 - accuracy: 0.9441
44288/48000 [==========================>...] - ETA: 0s - loss: 0.1894 - accuracy: 0.9439
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1902 - accuracy: 0.9437 - val_loss: 0.1154 - val_accuracy: 0.9682
Epoch 8/20

  128/48000 [..............................] - ETA: 1s - loss: 0.2888 - accuracy: 0.8984
 4608/48000 [=>............................] - ETA: 0s - loss: 0.1670 - accuracy: 0.9481
 8960/48000 [====>.........................] - ETA: 0s - loss: 0.1744 - accuracy: 0.9473
13312/48000 [=======>......................] - ETA: 0s - loss: 0.1777 - accuracy: 0.9481
17920/48000 [==========>...................] - ETA: 0s - loss: 0.1785 - accuracy: 0.9483
22528/48000 [=============>................] - ETA: 0s - loss: 0.1773 - accuracy: 0.9490
26880/48000 [===============>..............] - ETA: 0s - loss: 0.1788 - accuracy: 0.9486
31232/48000 [==================>...........] - ETA: 0s - loss: 0.1747 - accuracy: 0.9499
35584/48000 [=====================>........] - ETA: 0s - loss: 0.1753 - accuracy: 0.9497
40064/48000 [========================>.....] - ETA: 0s - loss: 0.1769 - accuracy: 0.9490
44544/48000 [==========================>...] - ETA: 0s - loss: 0.1767 - accuracy: 0.9486
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1763 - accuracy: 0.9486 - val_loss: 0.1048 - val_accuracy: 0.9696
Epoch 9/20

  128/48000 [..............................] - ETA: 0s - loss: 0.2176 - accuracy: 0.9141
 4352/48000 [=>............................] - ETA: 0s - loss: 0.1750 - accuracy: 0.9515
 8704/48000 [====>.........................] - ETA: 0s - loss: 0.1676 - accuracy: 0.9519
13056/48000 [=======>......................] - ETA: 0s - loss: 0.1678 - accuracy: 0.9514
17280/48000 [=========>....................] - ETA: 0s - loss: 0.1687 - accuracy: 0.9497
21504/48000 [============>.................] - ETA: 0s - loss: 0.1686 - accuracy: 0.9496
25856/48000 [===============>..............] - ETA: 0s - loss: 0.1663 - accuracy: 0.9505
30080/48000 [=================>............] - ETA: 0s - loss: 0.1647 - accuracy: 0.9509
34432/48000 [====================>.........] - ETA: 0s - loss: 0.1657 - accuracy: 0.9515
38784/48000 [=======================>......] - ETA: 0s - loss: 0.1667 - accuracy: 0.9516
43136/48000 [=========================>....] - ETA: 0s - loss: 0.1662 - accuracy: 0.9518
47488/48000 [============================>.] - ETA: 0s - loss: 0.1671 - accuracy: 0.9517
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1669 - accuracy: 0.9517 - val_loss: 0.1016 - val_accuracy: 0.9700
Epoch 10/20

  128/48000 [..............................] - ETA: 0s - loss: 0.1113 - accuracy: 0.9688
 4608/48000 [=>............................] - ETA: 0s - loss: 0.1628 - accuracy: 0.9525
 9088/48000 [====>.........................] - ETA: 0s - loss: 0.1765 - accuracy: 0.9499
13568/48000 [=======>......................] - ETA: 0s - loss: 0.1664 - accuracy: 0.9528
17920/48000 [==========>...................] - ETA: 0s - loss: 0.1614 - accuracy: 0.9538
22400/48000 [=============>................] - ETA: 0s - loss: 0.1646 - accuracy: 0.9523
26880/48000 [===============>..............] - ETA: 0s - loss: 0.1639 - accuracy: 0.9522
31360/48000 [==================>...........] - ETA: 0s - loss: 0.1615 - accuracy: 0.9526
35712/48000 [=====================>........] - ETA: 0s - loss: 0.1627 - accuracy: 0.9523
40192/48000 [========================>.....] - ETA: 0s - loss: 0.1625 - accuracy: 0.9521
44672/48000 [==========================>...] - ETA: 0s - loss: 0.1628 - accuracy: 0.9519
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1635 - accuracy: 0.9519 - val_loss: 0.1066 - val_accuracy: 0.9704
Epoch 11/20

  128/48000 [..............................] - ETA: 0s - loss: 0.1022 - accuracy: 0.9609
 4352/48000 [=>............................] - ETA: 0s - loss: 0.1781 - accuracy: 0.9478
 8832/48000 [====>.........................] - ETA: 0s - loss: 0.1660 - accuracy: 0.9511
13184/48000 [=======>......................] - ETA: 0s - loss: 0.1592 - accuracy: 0.9532
17536/48000 [=========>....................] - ETA: 0s - loss: 0.1589 - accuracy: 0.9536
21760/48000 [============>.................] - ETA: 0s - loss: 0.1547 - accuracy: 0.9543
25984/48000 [===============>..............] - ETA: 0s - loss: 0.1524 - accuracy: 0.9552
30336/48000 [=================>............] - ETA: 0s - loss: 0.1535 - accuracy: 0.9547
34816/48000 [====================>.........] - ETA: 0s - loss: 0.1528 - accuracy: 0.9547
39168/48000 [=======================>......] - ETA: 0s - loss: 0.1529 - accuracy: 0.9548
43520/48000 [==========================>...] - ETA: 0s - loss: 0.1521 - accuracy: 0.9548
47872/48000 [============================>.] - ETA: 0s - loss: 0.1518 - accuracy: 0.9545
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1518 - accuracy: 0.9545 - val_loss: 0.1014 - val_accuracy: 0.9712
Epoch 12/20

  128/48000 [..............................] - ETA: 0s - loss: 0.1370 - accuracy: 0.9609
 4352/48000 [=>............................] - ETA: 0s - loss: 0.1406 - accuracy: 0.9577
 8832/48000 [====>.........................] - ETA: 0s - loss: 0.1445 - accuracy: 0.9578
13312/48000 [=======>......................] - ETA: 0s - loss: 0.1411 - accuracy: 0.9597
17664/48000 [==========>...................] - ETA: 0s - loss: 0.1426 - accuracy: 0.9591
22016/48000 [============>.................] - ETA: 0s - loss: 0.1462 - accuracy: 0.9577
26368/48000 [===============>..............] - ETA: 0s - loss: 0.1494 - accuracy: 0.9567
30848/48000 [==================>...........] - ETA: 0s - loss: 0.1487 - accuracy: 0.9568
35072/48000 [====================>.........] - ETA: 0s - loss: 0.1474 - accuracy: 0.9566
39424/48000 [=======================>......] - ETA: 0s - loss: 0.1470 - accuracy: 0.9561
43776/48000 [==========================>...] - ETA: 0s - loss: 0.1462 - accuracy: 0.9561
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1474 - accuracy: 0.9554 - val_loss: 0.1024 - val_accuracy: 0.9710
Epoch 13/20

  128/48000 [..............................] - ETA: 0s - loss: 0.2528 - accuracy: 0.9219
 4352/48000 [=>............................] - ETA: 0s - loss: 0.1431 - accuracy: 0.9589
 8704/48000 [====>.........................] - ETA: 0s - loss: 0.1409 - accuracy: 0.9585
13056/48000 [=======>......................] - ETA: 0s - loss: 0.1380 - accuracy: 0.9589
17664/48000 [==========>...................] - ETA: 0s - loss: 0.1387 - accuracy: 0.9597
22016/48000 [============>.................] - ETA: 0s - loss: 0.1407 - accuracy: 0.9590
26496/48000 [===============>..............] - ETA: 0s - loss: 0.1437 - accuracy: 0.9578
30976/48000 [==================>...........] - ETA: 0s - loss: 0.1427 - accuracy: 0.9583
35328/48000 [=====================>........] - ETA: 0s - loss: 0.1414 - accuracy: 0.9586
39680/48000 [=======================>......] - ETA: 0s - loss: 0.1398 - accuracy: 0.9589
44160/48000 [==========================>...] - ETA: 0s - loss: 0.1416 - accuracy: 0.9583
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1417 - accuracy: 0.9581 - val_loss: 0.0939 - val_accuracy: 0.9737
Epoch 14/20

  128/48000 [..............................] - ETA: 0s - loss: 0.2275 - accuracy: 0.9609
 4608/48000 [=>............................] - ETA: 0s - loss: 0.1384 - accuracy: 0.9590
 9088/48000 [====>.........................] - ETA: 0s - loss: 0.1388 - accuracy: 0.9592
13440/48000 [=======>......................] - ETA: 0s - loss: 0.1443 - accuracy: 0.9564
17920/48000 [==========>...................] - ETA: 0s - loss: 0.1409 - accuracy: 0.9570
22400/48000 [=============>................] - ETA: 0s - loss: 0.1413 - accuracy: 0.9565
26752/48000 [===============>..............] - ETA: 0s - loss: 0.1411 - accuracy: 0.9569
31104/48000 [==================>...........] - ETA: 0s - loss: 0.1417 - accuracy: 0.9566
35584/48000 [=====================>........] - ETA: 0s - loss: 0.1411 - accuracy: 0.9568
39936/48000 [=======================>......] - ETA: 0s - loss: 0.1399 - accuracy: 0.9575
44288/48000 [==========================>...] - ETA: 0s - loss: 0.1408 - accuracy: 0.9576
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1404 - accuracy: 0.9576 - val_loss: 0.0975 - val_accuracy: 0.9733
Epoch 15/20

  128/48000 [..............................] - ETA: 0s - loss: 0.0623 - accuracy: 0.9766
 4480/48000 [=>............................] - ETA: 0s - loss: 0.1212 - accuracy: 0.9634
 8832/48000 [====>.........................] - ETA: 0s - loss: 0.1299 - accuracy: 0.9613
13184/48000 [=======>......................] - ETA: 0s - loss: 0.1335 - accuracy: 0.9607
17664/48000 [==========>...................] - ETA: 0s - loss: 0.1344 - accuracy: 0.9605
22016/48000 [============>.................] - ETA: 0s - loss: 0.1358 - accuracy: 0.9600
26496/48000 [===============>..............] - ETA: 0s - loss: 0.1355 - accuracy: 0.9597
30848/48000 [==================>...........] - ETA: 0s - loss: 0.1351 - accuracy: 0.9595
35328/48000 [=====================>........] - ETA: 0s - loss: 0.1343 - accuracy: 0.9597
39680/48000 [=======================>......] - ETA: 0s - loss: 0.1351 - accuracy: 0.9592
44032/48000 [==========================>...] - ETA: 0s - loss: 0.1350 - accuracy: 0.9593
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1359 - accuracy: 0.9591 - val_loss: 0.0933 - val_accuracy: 0.9748
Epoch 16/20

  128/48000 [..............................] - ETA: 0s - loss: 0.1964 - accuracy: 0.9297
 4480/48000 [=>............................] - ETA: 0s - loss: 0.1296 - accuracy: 0.9603
 8832/48000 [====>.........................] - ETA: 0s - loss: 0.1315 - accuracy: 0.9604
13184/48000 [=======>......................] - ETA: 0s - loss: 0.1325 - accuracy: 0.9595
17408/48000 [=========>....................] - ETA: 0s - loss: 0.1310 - accuracy: 0.9598
21760/48000 [============>.................] - ETA: 0s - loss: 0.1327 - accuracy: 0.9594
26112/48000 [===============>..............] - ETA: 0s - loss: 0.1329 - accuracy: 0.9597
30592/48000 [==================>...........] - ETA: 0s - loss: 0.1331 - accuracy: 0.9594
34816/48000 [====================>.........] - ETA: 0s - loss: 0.1331 - accuracy: 0.9598
39296/48000 [=======================>......] - ETA: 0s - loss: 0.1339 - accuracy: 0.9594
43648/48000 [==========================>...] - ETA: 0s - loss: 0.1339 - accuracy: 0.9593
47872/48000 [============================>.] - ETA: 0s - loss: 0.1341 - accuracy: 0.9597
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1343 - accuracy: 0.9596 - val_loss: 0.0884 - val_accuracy: 0.9760
Epoch 17/20

  128/48000 [..............................] - ETA: 0s - loss: 0.0796 - accuracy: 0.9844
 4480/48000 [=>............................] - ETA: 0s - loss: 0.1242 - accuracy: 0.9665
 8960/48000 [====>.........................] - ETA: 0s - loss: 0.1236 - accuracy: 0.9655
13312/48000 [=======>......................] - ETA: 0s - loss: 0.1254 - accuracy: 0.9642
17792/48000 [==========>...................] - ETA: 0s - loss: 0.1324 - accuracy: 0.9612
22144/48000 [============>.................] - ETA: 0s - loss: 0.1299 - accuracy: 0.9611
26496/48000 [===============>..............] - ETA: 0s - loss: 0.1319 - accuracy: 0.9606
30976/48000 [==================>...........] - ETA: 0s - loss: 0.1332 - accuracy: 0.9601
35328/48000 [=====================>........] - ETA: 0s - loss: 0.1326 - accuracy: 0.9599
39680/48000 [=======================>......] - ETA: 0s - loss: 0.1312 - accuracy: 0.9603
44032/48000 [==========================>...] - ETA: 0s - loss: 0.1300 - accuracy: 0.9607
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1299 - accuracy: 0.9608 - val_loss: 0.0870 - val_accuracy: 0.9748
Epoch 18/20

  128/48000 [..............................] - ETA: 0s - loss: 0.0885 - accuracy: 0.9688
 4480/48000 [=>............................] - ETA: 0s - loss: 0.1158 - accuracy: 0.9638
 8704/48000 [====>.........................] - ETA: 0s - loss: 0.1159 - accuracy: 0.9640
12928/48000 [=======>......................] - ETA: 0s - loss: 0.1172 - accuracy: 0.9648
17152/48000 [=========>....................] - ETA: 0s - loss: 0.1196 - accuracy: 0.9639
21504/48000 [============>.................] - ETA: 0s - loss: 0.1216 - accuracy: 0.9635
25856/48000 [===============>..............] - ETA: 0s - loss: 0.1210 - accuracy: 0.9637
30208/48000 [=================>............] - ETA: 0s - loss: 0.1201 - accuracy: 0.9642
34560/48000 [====================>.........] - ETA: 0s - loss: 0.1196 - accuracy: 0.9645
39040/48000 [=======================>......] - ETA: 0s - loss: 0.1214 - accuracy: 0.9639
43520/48000 [==========================>...] - ETA: 0s - loss: 0.1223 - accuracy: 0.9636
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1222 - accuracy: 0.9638 - val_loss: 0.0859 - val_accuracy: 0.9747
Epoch 19/20

  128/48000 [..............................] - ETA: 0s - loss: 0.1141 - accuracy: 0.9766
 4480/48000 [=>............................] - ETA: 0s - loss: 0.1191 - accuracy: 0.9661
 8960/48000 [====>.........................] - ETA: 0s - loss: 0.1265 - accuracy: 0.9617
13440/48000 [=======>......................] - ETA: 0s - loss: 0.1254 - accuracy: 0.9615
17920/48000 [==========>...................] - ETA: 0s - loss: 0.1237 - accuracy: 0.9629
22272/48000 [============>.................] - ETA: 0s - loss: 0.1240 - accuracy: 0.9629
26752/48000 [===============>..............] - ETA: 0s - loss: 0.1219 - accuracy: 0.9634
31232/48000 [==================>...........] - ETA: 0s - loss: 0.1212 - accuracy: 0.9635
35712/48000 [=====================>........] - ETA: 0s - loss: 0.1211 - accuracy: 0.9638
40320/48000 [========================>.....] - ETA: 0s - loss: 0.1222 - accuracy: 0.9638
44800/48000 [===========================>..] - ETA: 0s - loss: 0.1225 - accuracy: 0.9637
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1228 - accuracy: 0.9633 - val_loss: 0.0885 - val_accuracy: 0.9760
Epoch 20/20

  128/48000 [..............................] - ETA: 0s - loss: 0.0988 - accuracy: 0.9609
 4736/48000 [=>............................] - ETA: 0s - loss: 0.1177 - accuracy: 0.9652
 9088/48000 [====>.........................] - ETA: 0s - loss: 0.1188 - accuracy: 0.9660
13440/48000 [=======>......................] - ETA: 0s - loss: 0.1206 - accuracy: 0.9640
17792/48000 [==========>...................] - ETA: 0s - loss: 0.1189 - accuracy: 0.9641
22272/48000 [============>.................] - ETA: 0s - loss: 0.1164 - accuracy: 0.9647
26752/48000 [===============>..............] - ETA: 0s - loss: 0.1171 - accuracy: 0.9649
31104/48000 [==================>...........] - ETA: 0s - loss: 0.1163 - accuracy: 0.9653
35200/48000 [=====================>........] - ETA: 0s - loss: 0.1179 - accuracy: 0.9649
39680/48000 [=======================>......] - ETA: 0s - loss: 0.1183 - accuracy: 0.9647
43904/48000 [==========================>...] - ETA: 0s - loss: 0.1191 - accuracy: 0.9645
48000/48000 [==============================] - 1s 13us/sample - loss: 0.1177 - accuracy: 0.9651 - val_loss: 0.0898 - val_accuracy: 0.9758

   32/10000 [..............................] - ETA: 0s - loss: 0.0405 - accuracy: 0.9688
 2976/10000 [=======>......................] - ETA: 0s - loss: 0.1290 - accuracy: 0.9647
 6048/10000 [=================>............] - ETA: 0s - loss: 0.1161 - accuracy: 0.9678
 9088/10000 [==========================>...] - ETA: 0s - loss: 0.0941 - accuracy: 0.9735
10000/10000 [==============================] - 0s 17us/sample - loss: 0.0925 - accuracy: 0.9738
'''