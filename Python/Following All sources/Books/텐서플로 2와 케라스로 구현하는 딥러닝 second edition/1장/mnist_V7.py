import tensorflow as tf
from tensorflow import keras

EPOCHS = 20
BATCH_SIZE = 256
VERBOSE = 1
NB_CLASSES = 10
N_HIDDEN = 128
VALIDATION_SPLIT=0.2
DROPOUT = 0.3

mnist = keras.datasets.mnist

(X_train, Y_train), (X_test, Y_test) = mnist.load_data()

RESHAPED = 784

X_train = X_train.reshape(60000, RESHAPED)
X_test = X_test.reshape(10000, RESHAPED)
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')

X_train, X_test = X_train / 255.0, X_test / 255.0

print(X_train.shape[0], 'train samples')
print(X_test.shape[0], 'test samples')
'''
60000 train samples
10000 test samples
'''

Y_train = tf.keras.utils.to_categorical(Y_train, NB_CLASSES)
Y_test = tf.keras.utils.to_categorical(Y_test, NB_CLASSES)

model = tf.keras.models.Sequential()
model.add(keras.layers.Dense(N_HIDDEN, input_shape=(RESHAPED,), name='dense_layer', activation='relu'))
model.add(keras.layers.Dropout(DROPOUT))
model.add(keras.layers.Dense(N_HIDDEN, name='dense_layer_2', activation='relu'))
model.add(keras.layers.Dropout(DROPOUT))
model.add(keras.layers.Dense(NB_CLASSES, name='dense_layer_3', activation='softmax'))

model.summary()
'''
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_layer (Dense)          (None, 128)               100480    
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense_layer_2 (Dense)        (None, 128)               16512     
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_layer_3 (Dense)        (None, 10)                1290      
=================================================================
Total params: 118,282
Trainable params: 118,282
Non-trainable params: 0
_________________________________________________________________
Train on 48000 samples, validate on 12000 samples
'''

model.compile(optimizer='Adam', loss='categorical_crossentropy', metrics=['accuracy'])
model.fit(X_train, Y_train, batch_size=BATCH_SIZE, epochs=EPOCHS, verbose=VERBOSE,
		  validation_split=VALIDATION_SPLIT)

test_loss, test_acc = model.evaluate(X_test, Y_test)

print('Test accuracy:', test_acc)
'''Test accuracy: 0.9782'''

predictions = model.predict(X_test)

'''
Epoch 1/20

  256/48000 [..............................] - ETA: 38s - loss: 2.4073 - accuracy: 0.0859
 5888/48000 [==>...........................] - ETA: 1s - loss: 1.7214 - accuracy: 0.4614 
11520/48000 [======>.......................] - ETA: 0s - loss: 1.2926 - accuracy: 0.5925
17408/48000 [=========>....................] - ETA: 0s - loss: 1.0532 - accuracy: 0.6699
23552/48000 [=============>................] - ETA: 0s - loss: 0.9053 - accuracy: 0.7174
29440/48000 [=================>............] - ETA: 0s - loss: 0.8095 - accuracy: 0.7474
35328/48000 [=====================>........] - ETA: 0s - loss: 0.7368 - accuracy: 0.7704
41216/48000 [========================>.....] - ETA: 0s - loss: 0.6809 - accuracy: 0.7885
47104/48000 [============================>.] - ETA: 0s - loss: 0.6389 - accuracy: 0.8026
48000/48000 [==============================] - 1s 15us/sample - loss: 0.6334 - accuracy: 0.8045 - val_loss: 0.2166 - val_accuracy: 0.9362
Epoch 2/20

  256/48000 [..............................] - ETA: 0s - loss: 0.2612 - accuracy: 0.9375
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.3001 - accuracy: 0.9126
12032/48000 [======>.......................] - ETA: 0s - loss: 0.2850 - accuracy: 0.9159
18176/48000 [==========>...................] - ETA: 0s - loss: 0.2796 - accuracy: 0.9172
24064/48000 [==============>...............] - ETA: 0s - loss: 0.2799 - accuracy: 0.9171
29696/48000 [=================>............] - ETA: 0s - loss: 0.2763 - accuracy: 0.9186
35584/48000 [=====================>........] - ETA: 0s - loss: 0.2747 - accuracy: 0.9184
41472/48000 [========================>.....] - ETA: 0s - loss: 0.2698 - accuracy: 0.9203
47360/48000 [============================>.] - ETA: 0s - loss: 0.2673 - accuracy: 0.9212
48000/48000 [==============================] - 0s 10us/sample - loss: 0.2666 - accuracy: 0.9214 - val_loss: 0.1534 - val_accuracy: 0.9562
Epoch 3/20

  256/48000 [..............................] - ETA: 0s - loss: 0.2307 - accuracy: 0.9531
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.2161 - accuracy: 0.9388
12032/48000 [======>.......................] - ETA: 0s - loss: 0.2128 - accuracy: 0.9379
17920/48000 [==========>...................] - ETA: 0s - loss: 0.2121 - accuracy: 0.9368
23552/48000 [=============>................] - ETA: 0s - loss: 0.2099 - accuracy: 0.9373
29440/48000 [=================>............] - ETA: 0s - loss: 0.2080 - accuracy: 0.9375
35328/48000 [=====================>........] - ETA: 0s - loss: 0.2060 - accuracy: 0.9383
41216/48000 [========================>.....] - ETA: 0s - loss: 0.2029 - accuracy: 0.9394
47616/48000 [============================>.] - ETA: 0s - loss: 0.2015 - accuracy: 0.9398
48000/48000 [==============================] - 0s 10us/sample - loss: 0.2015 - accuracy: 0.9397 - val_loss: 0.1267 - val_accuracy: 0.9627
Epoch 4/20

  256/48000 [..............................] - ETA: 0s - loss: 0.1437 - accuracy: 0.9570
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.1691 - accuracy: 0.9489
12032/48000 [======>.......................] - ETA: 0s - loss: 0.1704 - accuracy: 0.9481
17920/48000 [==========>...................] - ETA: 0s - loss: 0.1709 - accuracy: 0.9480
23808/48000 [=============>................] - ETA: 0s - loss: 0.1695 - accuracy: 0.9491
29696/48000 [=================>............] - ETA: 0s - loss: 0.1686 - accuracy: 0.9492
35840/48000 [=====================>........] - ETA: 0s - loss: 0.1691 - accuracy: 0.9496
41728/48000 [=========================>....] - ETA: 0s - loss: 0.1701 - accuracy: 0.9492
47616/48000 [============================>.] - ETA: 0s - loss: 0.1706 - accuracy: 0.9487
48000/48000 [==============================] - 0s 10us/sample - loss: 0.1704 - accuracy: 0.9488 - val_loss: 0.1108 - val_accuracy: 0.9672
Epoch 5/20

  256/48000 [..............................] - ETA: 0s - loss: 0.1178 - accuracy: 0.9688
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.1437 - accuracy: 0.9557
12032/48000 [======>.......................] - ETA: 0s - loss: 0.1437 - accuracy: 0.9563
17920/48000 [==========>...................] - ETA: 0s - loss: 0.1469 - accuracy: 0.9554
23808/48000 [=============>................] - ETA: 0s - loss: 0.1452 - accuracy: 0.9557
29696/48000 [=================>............] - ETA: 0s - loss: 0.1438 - accuracy: 0.9566
35584/48000 [=====================>........] - ETA: 0s - loss: 0.1447 - accuracy: 0.9566
41472/48000 [========================>.....] - ETA: 0s - loss: 0.1444 - accuracy: 0.9565
47360/48000 [============================>.] - ETA: 0s - loss: 0.1447 - accuracy: 0.9568
48000/48000 [==============================] - 0s 10us/sample - loss: 0.1448 - accuracy: 0.9567 - val_loss: 0.1024 - val_accuracy: 0.9684
Epoch 6/20

  256/48000 [..............................] - ETA: 0s - loss: 0.1199 - accuracy: 0.9648
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.1358 - accuracy: 0.9603
11776/48000 [======>.......................] - ETA: 0s - loss: 0.1328 - accuracy: 0.9600
17664/48000 [==========>...................] - ETA: 0s - loss: 0.1317 - accuracy: 0.9609
23296/48000 [=============>................] - ETA: 0s - loss: 0.1330 - accuracy: 0.9596
29184/48000 [=================>............] - ETA: 0s - loss: 0.1333 - accuracy: 0.9603
35072/48000 [====================>.........] - ETA: 0s - loss: 0.1311 - accuracy: 0.9611
40960/48000 [========================>.....] - ETA: 0s - loss: 0.1308 - accuracy: 0.9608
46848/48000 [============================>.] - ETA: 0s - loss: 0.1289 - accuracy: 0.9616
48000/48000 [==============================] - 0s 10us/sample - loss: 0.1287 - accuracy: 0.9616 - val_loss: 0.0999 - val_accuracy: 0.9712
Epoch 7/20

  256/48000 [..............................] - ETA: 0s - loss: 0.1057 - accuracy: 0.9648
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.1142 - accuracy: 0.9655
12032/48000 [======>.......................] - ETA: 0s - loss: 0.1145 - accuracy: 0.9649
18176/48000 [==========>...................] - ETA: 0s - loss: 0.1165 - accuracy: 0.9646
24064/48000 [==============>...............] - ETA: 0s - loss: 0.1157 - accuracy: 0.9651
29952/48000 [=================>............] - ETA: 0s - loss: 0.1171 - accuracy: 0.9649
35840/48000 [=====================>........] - ETA: 0s - loss: 0.1165 - accuracy: 0.9648
41728/48000 [=========================>....] - ETA: 0s - loss: 0.1147 - accuracy: 0.9652
47616/48000 [============================>.] - ETA: 0s - loss: 0.1151 - accuracy: 0.9651
48000/48000 [==============================] - 0s 10us/sample - loss: 0.1153 - accuracy: 0.9651 - val_loss: 0.0967 - val_accuracy: 0.9706
Epoch 8/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0883 - accuracy: 0.9688
 5888/48000 [==>...........................] - ETA: 0s - loss: 0.0993 - accuracy: 0.9699
11776/48000 [======>.......................] - ETA: 0s - loss: 0.0973 - accuracy: 0.9699
17664/48000 [==========>...................] - ETA: 0s - loss: 0.1054 - accuracy: 0.9673
23552/48000 [=============>................] - ETA: 0s - loss: 0.1056 - accuracy: 0.9683
29440/48000 [=================>............] - ETA: 0s - loss: 0.1052 - accuracy: 0.9682
35328/48000 [=====================>........] - ETA: 0s - loss: 0.1068 - accuracy: 0.9680
41216/48000 [========================>.....] - ETA: 0s - loss: 0.1054 - accuracy: 0.9685
47104/48000 [============================>.] - ETA: 0s - loss: 0.1059 - accuracy: 0.9684
48000/48000 [==============================] - 0s 10us/sample - loss: 0.1065 - accuracy: 0.9683 - val_loss: 0.0899 - val_accuracy: 0.9731
Epoch 9/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0900 - accuracy: 0.9727
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.0911 - accuracy: 0.9715
12032/48000 [======>.......................] - ETA: 0s - loss: 0.0937 - accuracy: 0.9699
17920/48000 [==========>...................] - ETA: 0s - loss: 0.0957 - accuracy: 0.9693
23552/48000 [=============>................] - ETA: 0s - loss: 0.1008 - accuracy: 0.9687
29184/48000 [=================>............] - ETA: 0s - loss: 0.1003 - accuracy: 0.9695
34816/48000 [====================>.........] - ETA: 0s - loss: 0.0993 - accuracy: 0.9698
40448/48000 [========================>.....] - ETA: 0s - loss: 0.0982 - accuracy: 0.9701
46080/48000 [===========================>..] - ETA: 0s - loss: 0.0979 - accuracy: 0.9701
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0984 - accuracy: 0.9698 - val_loss: 0.0926 - val_accuracy: 0.9734
Epoch 10/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0938 - accuracy: 0.9570
 6400/48000 [===>..........................] - ETA: 0s - loss: 0.1003 - accuracy: 0.9695
12544/48000 [======>.......................] - ETA: 0s - loss: 0.0933 - accuracy: 0.9704
18432/48000 [==========>...................] - ETA: 0s - loss: 0.0922 - accuracy: 0.9715
24320/48000 [==============>...............] - ETA: 0s - loss: 0.0921 - accuracy: 0.9714
30208/48000 [=================>............] - ETA: 0s - loss: 0.0900 - accuracy: 0.9724
36096/48000 [=====================>........] - ETA: 0s - loss: 0.0911 - accuracy: 0.9721
41984/48000 [=========================>....] - ETA: 0s - loss: 0.0917 - accuracy: 0.9721
47872/48000 [============================>.] - ETA: 0s - loss: 0.0922 - accuracy: 0.9716
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0921 - accuracy: 0.9716 - val_loss: 0.0832 - val_accuracy: 0.9760
Epoch 11/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0663 - accuracy: 0.9805
 6400/48000 [===>..........................] - ETA: 0s - loss: 0.0881 - accuracy: 0.9742
12288/48000 [======>.......................] - ETA: 0s - loss: 0.0870 - accuracy: 0.9742
18176/48000 [==========>...................] - ETA: 0s - loss: 0.0875 - accuracy: 0.9742
24064/48000 [==============>...............] - ETA: 0s - loss: 0.0871 - accuracy: 0.9741
29952/48000 [=================>............] - ETA: 0s - loss: 0.0844 - accuracy: 0.9746
36096/48000 [=====================>........] - ETA: 0s - loss: 0.0844 - accuracy: 0.9745
41984/48000 [=========================>....] - ETA: 0s - loss: 0.0855 - accuracy: 0.9740
47872/48000 [============================>.] - ETA: 0s - loss: 0.0848 - accuracy: 0.9741
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0847 - accuracy: 0.9741 - val_loss: 0.0814 - val_accuracy: 0.9764
Epoch 12/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0774 - accuracy: 0.9805
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.0773 - accuracy: 0.9761
11776/48000 [======>.......................] - ETA: 0s - loss: 0.0755 - accuracy: 0.9773
17664/48000 [==========>...................] - ETA: 0s - loss: 0.0744 - accuracy: 0.9771
23552/48000 [=============>................] - ETA: 0s - loss: 0.0781 - accuracy: 0.9764
29440/48000 [=================>............] - ETA: 0s - loss: 0.0766 - accuracy: 0.9766
35328/48000 [=====================>........] - ETA: 0s - loss: 0.0771 - accuracy: 0.9763
41216/48000 [========================>.....] - ETA: 0s - loss: 0.0767 - accuracy: 0.9765
47104/48000 [============================>.] - ETA: 0s - loss: 0.0770 - accuracy: 0.9764
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0776 - accuracy: 0.9762 - val_loss: 0.0835 - val_accuracy: 0.9741
Epoch 13/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0806 - accuracy: 0.9766
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.0683 - accuracy: 0.9787
12032/48000 [======>.......................] - ETA: 0s - loss: 0.0687 - accuracy: 0.9782
17920/48000 [==========>...................] - ETA: 0s - loss: 0.0699 - accuracy: 0.9778
23808/48000 [=============>................] - ETA: 0s - loss: 0.0707 - accuracy: 0.9770
29696/48000 [=================>............] - ETA: 0s - loss: 0.0728 - accuracy: 0.9764
35584/48000 [=====================>........] - ETA: 0s - loss: 0.0734 - accuracy: 0.9760
41472/48000 [========================>.....] - ETA: 0s - loss: 0.0753 - accuracy: 0.9753
47360/48000 [============================>.] - ETA: 0s - loss: 0.0752 - accuracy: 0.9754
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0749 - accuracy: 0.9756 - val_loss: 0.0796 - val_accuracy: 0.9770
Epoch 14/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0944 - accuracy: 0.9648
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.0753 - accuracy: 0.9761
12032/48000 [======>.......................] - ETA: 0s - loss: 0.0741 - accuracy: 0.9757
17920/48000 [==========>...................] - ETA: 0s - loss: 0.0720 - accuracy: 0.9765
23808/48000 [=============>................] - ETA: 0s - loss: 0.0724 - accuracy: 0.9758
29696/48000 [=================>............] - ETA: 0s - loss: 0.0727 - accuracy: 0.9762
35584/48000 [=====================>........] - ETA: 0s - loss: 0.0726 - accuracy: 0.9762
41472/48000 [========================>.....] - ETA: 0s - loss: 0.0722 - accuracy: 0.9762
47360/48000 [============================>.] - ETA: 0s - loss: 0.0720 - accuracy: 0.9762
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0718 - accuracy: 0.9762 - val_loss: 0.0787 - val_accuracy: 0.9767
Epoch 15/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0458 - accuracy: 0.9844
 5888/48000 [==>...........................] - ETA: 0s - loss: 0.0635 - accuracy: 0.9800
11520/48000 [======>.......................] - ETA: 0s - loss: 0.0695 - accuracy: 0.9781
17152/48000 [=========>....................] - ETA: 0s - loss: 0.0677 - accuracy: 0.9781
22784/48000 [=============>................] - ETA: 0s - loss: 0.0691 - accuracy: 0.9773
28416/48000 [================>.............] - ETA: 0s - loss: 0.0689 - accuracy: 0.9774
34048/48000 [====================>.........] - ETA: 0s - loss: 0.0700 - accuracy: 0.9773
39680/48000 [=======================>......] - ETA: 0s - loss: 0.0701 - accuracy: 0.9774
45312/48000 [===========================>..] - ETA: 0s - loss: 0.0690 - accuracy: 0.9777
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0692 - accuracy: 0.9776 - val_loss: 0.0761 - val_accuracy: 0.9778
Epoch 16/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0452 - accuracy: 0.9883
 6144/48000 [==>...........................] - ETA: 0s - loss: 0.0606 - accuracy: 0.9811
12032/48000 [======>.......................] - ETA: 0s - loss: 0.0609 - accuracy: 0.9805
17664/48000 [==========>...................] - ETA: 0s - loss: 0.0595 - accuracy: 0.9811
23296/48000 [=============>................] - ETA: 0s - loss: 0.0612 - accuracy: 0.9803
28928/48000 [=================>............] - ETA: 0s - loss: 0.0624 - accuracy: 0.9801
34560/48000 [====================>.........] - ETA: 0s - loss: 0.0624 - accuracy: 0.9802
40192/48000 [========================>.....] - ETA: 0s - loss: 0.0637 - accuracy: 0.9793
46080/48000 [===========================>..] - ETA: 0s - loss: 0.0647 - accuracy: 0.9789
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0646 - accuracy: 0.9790 - val_loss: 0.0772 - val_accuracy: 0.9777
Epoch 17/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0686 - accuracy: 0.9688
 5888/48000 [==>...........................] - ETA: 0s - loss: 0.0626 - accuracy: 0.9800
11520/48000 [======>.......................] - ETA: 0s - loss: 0.0619 - accuracy: 0.9805
17152/48000 [=========>....................] - ETA: 0s - loss: 0.0655 - accuracy: 0.9799
22784/48000 [=============>................] - ETA: 0s - loss: 0.0640 - accuracy: 0.9802
28416/48000 [================>.............] - ETA: 0s - loss: 0.0643 - accuracy: 0.9802
34048/48000 [====================>.........] - ETA: 0s - loss: 0.0640 - accuracy: 0.9797
39680/48000 [=======================>......] - ETA: 0s - loss: 0.0622 - accuracy: 0.9804
44800/48000 [===========================>..] - ETA: 0s - loss: 0.0623 - accuracy: 0.9804
48000/48000 [==============================] - 1s 11us/sample - loss: 0.0627 - accuracy: 0.9801 - val_loss: 0.0778 - val_accuracy: 0.9765
Epoch 18/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0678 - accuracy: 0.9727
 5632/48000 [==>...........................] - ETA: 0s - loss: 0.0557 - accuracy: 0.9821
10752/48000 [=====>........................] - ETA: 0s - loss: 0.0574 - accuracy: 0.9822
16128/48000 [=========>....................] - ETA: 0s - loss: 0.0589 - accuracy: 0.9817
21504/48000 [============>.................] - ETA: 0s - loss: 0.0569 - accuracy: 0.9820
26880/48000 [===============>..............] - ETA: 0s - loss: 0.0575 - accuracy: 0.9814
32256/48000 [===================>..........] - ETA: 0s - loss: 0.0589 - accuracy: 0.9809
37888/48000 [======================>.......] - ETA: 0s - loss: 0.0606 - accuracy: 0.9803
43264/48000 [==========================>...] - ETA: 0s - loss: 0.0614 - accuracy: 0.9799
48000/48000 [==============================] - 1s 11us/sample - loss: 0.0615 - accuracy: 0.9799 - val_loss: 0.0775 - val_accuracy: 0.9778
Epoch 19/20

  256/48000 [..............................] - ETA: 0s - loss: 0.0429 - accuracy: 0.9883
 5632/48000 [==>...........................] - ETA: 0s - loss: 0.0506 - accuracy: 0.9846
11264/48000 [======>.......................] - ETA: 0s - loss: 0.0528 - accuracy: 0.9827
16896/48000 [=========>....................] - ETA: 0s - loss: 0.0552 - accuracy: 0.9822
22784/48000 [=============>................] - ETA: 0s - loss: 0.0548 - accuracy: 0.9823
28160/48000 [================>.............] - ETA: 0s - loss: 0.0537 - accuracy: 0.9824
33280/48000 [===================>..........] - ETA: 0s - loss: 0.0548 - accuracy: 0.9820
38656/48000 [=======================>......] - ETA: 0s - loss: 0.0564 - accuracy: 0.9816
43520/48000 [==========================>...] - ETA: 0s - loss: 0.0560 - accuracy: 0.9816
48000/48000 [==============================] - 1s 11us/sample - loss: 0.0565 - accuracy: 0.9815 - val_loss: 0.0790 - val_accuracy: 0.9785
Epoch 20/20

  256/48000 [..............................] - ETA: 0s - loss: 0.1080 - accuracy: 0.9805
 5888/48000 [==>...........................] - ETA: 0s - loss: 0.0568 - accuracy: 0.9813
11264/48000 [======>.......................] - ETA: 0s - loss: 0.0541 - accuracy: 0.9814
16896/48000 [=========>....................] - ETA: 0s - loss: 0.0525 - accuracy: 0.9823
22528/48000 [=============>................] - ETA: 0s - loss: 0.0526 - accuracy: 0.9826
28416/48000 [================>.............] - ETA: 0s - loss: 0.0531 - accuracy: 0.9827
34048/48000 [====================>.........] - ETA: 0s - loss: 0.0532 - accuracy: 0.9828
39936/48000 [=======================>......] - ETA: 0s - loss: 0.0531 - accuracy: 0.9830
45568/48000 [===========================>..] - ETA: 0s - loss: 0.0534 - accuracy: 0.9827
48000/48000 [==============================] - 0s 10us/sample - loss: 0.0539 - accuracy: 0.9826 - val_loss: 0.0796 - val_accuracy: 0.9781

   32/10000 [..............................] - ETA: 0s - loss: 0.0503 - accuracy: 0.9688
 2784/10000 [=======>......................] - ETA: 0s - loss: 0.1020 - accuracy: 0.9691
 5760/10000 [================>.............] - ETA: 0s - loss: 0.0933 - accuracy: 0.9719
 8832/10000 [=========================>....] - ETA: 0s - loss: 0.0747 - accuracy: 0.9774
10000/10000 [==============================] - 0s 17us/sample - loss: 0.0744 - accuracy: 0.9782
'''